# SuiKe-C语言版本
一款桌面随机点名软件（还有Java版本）
# 第一章 需求分析
## 1.1 开发背景 
我们发现在中小学课堂教学中教师往往需要提问点名，当教师按顺序点名时，已经被抽到的学生往往会有所懈怠而不能高效听讲；当教师随机点名时，又存在主观偏向性，学生被抽到的概率很难保证相等。随课软件拥有加权随机抽取功能和纯随机抽取功能便可以解决这些问题，能够有效的调动学生的学习积极性。
## 1.2 市场分析 
### 1.2.1 目标用户 
全国中小学教师。
### 1.2.2 竞争软件分析 
目前市面上的随机点名软件大多仅支持概率相同的随机点名，而且可视化程度不高，对学生的学习情况无法进行记录，导入导出数据比较麻烦。而本项目不仅拥有这些软件所拥有的功能，还支持加权随机抽取、语音播报、学情信息统计与分析，支持学情信息的导入和导出以及操作审计等功能，并且教师可以选择授课内容，能轻松完成对不同授课班级学生的管理。随课是一款主要面向于中小学老师的电子白板课堂点名软件。
1. 支持对老师提前导入的题目进行题目展示。
2. 支持课程和学生的信息管理。
3. 支持抽取时进行语音播报。
4. 具有纯随机抽取和加权随机抽取功能。
5. 支持对用户操作进行审计。
6. 支持对不同账号进行不同的偏好设置。
# 第二章 概要设计
## 2.1 总体设计 
该软件在界面模块设计中拥有首页信息、学生管理、课堂考勤、课堂抽问、随机抽取、设
置管理六大模块。 同时，在算法设计中通过对学生的缺勤次数，得分评价等进行加权随机抽
取。
## 2.2 技术框架 

1．该软件使用 Visual Stdio 软件，运用 C++语言进行整体的算法设计。

2．通过调用 Speech SDK 来制作动态链接库来实现语音播报功能。

3．通过使用 EasyX 图形库来进行该软件的图形化用户交互界面的设计。
## 2.3 模块设计 
该软件采用模块化设计，同时实现对学生和教师的信息管理，方便不同老师的使用。同时由于学生对于不同学科有不同的学习情况，该软件方便对学生不同学科的管理。在抽取中采用加权抽取，以便于对不同程度的学生抽取时都有所照顾。
# 第三章 详细设计
作品制作重点：

1.对于学生概率的计算是该作品设计的重点，通过对学生使用学生的概率的加权计算，
从而更加智能的抽取学生。

2.在加权抽取过程中需要对每个学生的学习情况进行分析，因此对学生信息的管理也是
该作品设计的重点。
作品制作难点：

1.对抽取概率的设计，通过大量的计算来判断设置的每一个参数的合适值，如果参数值
不合适会造成学生概率计算出现过大或者过小这种极端情况。

2.抽取过程中进行语音播报，通过进行运用 Speech SDK 来进行扬声器 COM 端口的调
用，从而进行学号播报。
## 3.1 界面设计 
该软件在界面设计上共分为首页信息、学生管理、课堂考勤、课堂抽问、随机抽取、设置管理六大模块(其中课堂考勤和课堂抽问使用了加权随机抽取算法)。

1.首页信息：包括修改信息，选择课程，用户登陆三个小模块。
修改信息包括添加课程、删除课程、修改密码三个功能。
用户登陆包括用户的登陆、注册、找回密码。

2.学生管理：包括查看学生信息、修改学生信息两个小模块。
修改学生信息中包括对学生信息的增加，删除，重置和清空。还可以对该课程中的学生信息进行导入和导出。

3.课堂考勤：包括抽取功能和手动添加功能。
抽取功能：通过对学生信息的分析，对学生进行加权，改变不同学生被抽到的概率，从而使那些可能缺勤概率大的同学被抽到的概率大。
手动添加：已经得知该学生在本节课缺勤，可以手动添加，对该学生进行缺勤记录。

4.课堂抽问：包括按照难度抽取功能和按照题目抽取功能。
按难度抽取：通过设计简单，一般，较难，困难四个难度参数进行数据抽取，那些学习情况较好的学生对于难度较大的题目被抽到的概率更高，学习情况较差的学生对于难度较低的题目被抽到的概率更高，有利于激发不同学习情况的学生的学习积极性。
按题目抽取：老师在上课前可以事先把题目导入到该软件中，可以方便抽取，避免切屏的麻烦。

5.随机抽取：纯随机抽取功能。
不对学生增加权重，直接进行纯随机抽取，抽到的学生也不计入提问次数。

6.设置管理：语音播报设置、学生参考设置、音效设置功能。 
语音播报设置：对抽到的学生的学号语音播报进行开关。
学生参考设置：通过对学生参考的设置，可以使软件更加关注于学生的近
期学习情况或者学生的远期学习情况。
音效设置：对按钮音效进行开关。
## 3.2 关键算法 
该软件在算法设计有三点体现，分别体现在总分数计算，考勤抽取，提问抽取。

1.总分数计算：在每次的提问过后，都会有一个得分评价和一个 reduce 系数，通过对reduce 数值的设置，可以达到本次分数合并为总分数的数值，往往来说，reduce 系数越大本次分数所占的权重就越大，从而更加注重学生的近期表现。

2.考勤抽取：首先计算出考勤概率因子，概率因子与该学生的被抽次数和总分数呈负相关，缺勤次数呈正相关。同时被抽次数还参与正弦函数，使每个学生的概率因子呈周期性变化。通过计算出每位学生的概率因子，来算出每个学生的概率范围，再通过产生随机数判断落入的概率范围。在这里也会设置一个 mark 系数，抽取到后 mark 系数大幅度降低，从而大幅度降低该学生下次被抽到的概率。
<img width="744" height="616" alt="image" src="https://github.com/user-attachments/assets/16e8d042-53ae-467e-ae98-1986ab0adc82" />

3.提问抽取：首先计算出提问概率因子，概率因子与该学生的被提问次数和总分数呈负相关，缺勤次数呈正相关。同时被抽次数还参与正弦函数，使每个学生的概率因子呈周期性变化。在这里会设置题目难度系数，使得学习程度好的学生对于困难的题目被抽到的概率大，学习程度底的学生对于容易的题目被抽到的概率大。通过概率因子计算概率范围，最后通过随机数判断落入的概率范围，来抽取学生。
<img width="709" height="604" alt="image" src="https://github.com/user-attachments/assets/e9a1fc7a-7eed-440d-9476-4ad654d310de" />
# 第四章 安装及使用
## 4.1 环境要求 
已安装含 Windows7 及以上操作系统的电子白板。
## 4.2 安装 
打开随课自解压压缩包，同意该许可证，选择安装目录，点击“确定”，桌面会自动创建快捷方式。点击快捷方式即可打开。
## 4.3 使用说明 
该软件在使用时，首次使用要先点击用户登陆，进行用户的注册和登陆，然后在首页信息中点击修改信息，添加课程，添加课程后返回。返回后点击选择课程，选择该课程，然后进入学生管理，点击修改学生信息，进去后可以一个一个对学生进行添加，也可以直接导入学生名单（注意格式为 学号，姓名，分数（初始为 60 分），提问次数（初始为 0 次），缺勤次数（初始为 0 次））。学生信息添加完成后，可以返回进入查看学生信息从而对学生的信息进行查看。学生添加完成后就可以进行课堂考勤，课堂抽问，随机抽取等。在以后进行登陆时，可以直接点击用户登陆，登陆该用户，然后选择已经添加的课程，就可以直接进行对学生的抽取。
